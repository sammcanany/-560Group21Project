IF EXISTS(SELECT 1 FROM sys.tables WHERE object_id = OBJECT_ID('Flight'))
BEGIN;
    DROP TABLE [Flight];
END;
GO

CREATE TABLE [Flight] (
    [FlightNumber] VARCHAR(6) NOT NULL PRIMARY KEY,
    [To] CHAR(3) NOT NULL FOREIGN KEY REFERENCES dbo.Airport(AirportCode),
    [From] CHAR(3) NOT NULL FOREIGN KEY REFERENCES dbo.Airport(AirportCode),
	  [Distance] FLOAT NOT NULL,
	  CONSTRAINT FlightArriveFrom CHECK ([From] != [To])
);
GO

INSERT INTO [Flight] (FlightNumber,[To],[From],[Distance])
VALUES
  ('IRT411','ATL','DFW',1176.53),
('XLT411','ATL','DEN',1928.5),
('ROM411','ATL','ORD',977),
('ISJ411','ATL','LAX',3129.33),
('LWF411','ATL','CLT',364.01),
('ILH411','ATL','LAS',2808.02),
('VTH411','ATL','PHX',2551.55),
('SYF411','ATL','MCO',651.09),
('WLK411','ATL','MHK',1255.19),
('JJA991','DFW','ATL',1176.53),
('ZDX991','DFW','DEN',1031.84),
('UOI991','DFW','ORD',1291.84),
('ETY991','DFW','LAX',1984.84),
('YWY991','DFW','CLT',1504.71),
('MNP991','DFW','LAS',1696.28),
('STQ991','DFW','PHX',1394.43),
('XMU991','DFW','MCO',1583.98),
('QGC991','DFW','MHK',695.66),
('OPT595','DEN','ATL',1928.5),
('NBZ595','DEN','DFW',1031.84),
('JIF595','DEN','ORD',1427.68),
('LJO595','DEN','LAX',1385.85),
('LRI595','DEN','CLT',2149.98),
('XDR595','DEN','LAS',1009.52),
('IWW595','DEN','PHX',967.84),
('JFK595','DEN','MCO',2487.9),
('PDS595','DEN','MHK',691.48),
('TMW383','ORD','ATL',977),
('GIW383','ORD','DFW',1291.84),
('VFY383','ORD','DEN',1427.68),
('PRR383','ORD','LAX',2804.69),
('ZPO383','ORD','CLT',965.42),
('SBE383','ORD','LAS',2433.69),
('AGB383','ORD','PHX',2314.92),
('IAJ383','ORD','MCO',1621.24),
('DHK383','ORD','MHK',805.22),
('FFK686','LAX','ATL',3129.33),
('IXX686','LAX','DFW',1984.84),
('HPV686','LAX','DEN',1385.85),
('JEA686','LAX','ORD',2804.69),
('RQL686','LAX','CLT',3415.66),
('KHM686','LAX','LAS',380.71),
('ZJH686','LAX','PHX',595.41),
('HRE686','LAX','MCO',3565.55),
('GOX686','LAX','MHK',2022.27),
('QLL802','CLT','ATL',364.01),
('MDB802','CLT','DFW',1504.71),
('MPA802','CLT','DEN',2149.98),
('NHT802','CLT','ORD',965.42),
('URA802','CLT','LAX',3415.66),
('SIW802','CLT','LAS',3079.33),
('DJP802','CLT','PHX',2850.39),
('QXS802','CLT','MCO',755.56),
('WDY802','CLT','MHK',1459.35),
('CXO599','LAS','ATL',2808.02),
('FBJ599','LAS','DFW',1696.28),
('ARD599','LAS','DEN',1009.52),
('JWB599','LAS','ORD',2433.69),
('ZFB599','LAS','LAX',380.71),
('KWA599','LAS','CLT',3079.33),
('TFS599','LAS','PHX',411.82),
('HPI599','LAS','MCO',3279.11),
('HCF599','LAS','MHK',1661.34),
('IZO284','PHX','ATL',2551.55),
('TQZ284','PHX','DFW',1394.43),
('CJR284','PHX','DEN',967.84),
('MHF284','PHX','ORD',2314.92),
('KUA284','PHX','LAX',595.41),
('WIL284','PHX','CLT',2850.39),
('UEE284','PHX','LAS',411.82),
('NFB284','PHX','MCO',2971.85),
('SDY284','PHX','MHK',1512.44),
('GVI743','MCO','ATL',651.09),
('FYY743','MCO','DFW',1583.98),
('DRR743','MCO','DEN',2487.9),
('PQG743','MCO','ORD',1621.24),
('CWV743','MCO','LAX',3565.55),
('KYO743','MCO','CLT',755.56),
('UJL743','MCO','LAS',3279.11),
('RKG743','MCO','PHX',2971.85),
('WNY743','MCO','MHK',1849.96),
('BUT391','MHK','ATL',1255.19),
('MAN391','MHK','DFW',695.66),
('BWO391','MHK','DEN',691.48),
('IGJ391','MHK','ORD',805.22),
('GGC391','MHK','LAX',2022.27),
('IHS391','MHK','CLT',1459.35),
('FSI391','MHK','LAS',1661.34),
('IDH391','MHK','PHX',1512.44),
('NYT391','MHK','MCO',1849.96);
